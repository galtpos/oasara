# OASARA Project Structure

**Last Updated**: 2025-10-29
**Status**: Phase 1 Complete - Data Collection Infrastructure Ready

---

## 📁 Directory Structure

```
oasara-marketplace/
│
├── 📚 Documentation (Start Here)
│   ├── README.md                          # Main project overview
│   ├── QUICK-START-DATA-COLLECTION.md    # ⭐ Quick start guide (15 min)
│   ├── GOOGLE-PLACES-API-SETUP.md        # API key setup (10 min)
│   ├── DATA-COLLECTION-PLAN.md           # Complete 4-week plan
│   ├── DATA-COLLECTION-STATUS.md         # Current progress report
│   ├── SKILLS.md                          # Development best practices
│   ├── PROJECT-STRUCTURE.md              # This file
│   └── CLAUDE.md                          # ⬆ Parent: AI assistant context
│
├── 🗂️ Data Collection Scripts
│   ├── scripts/
│   │   ├── test-enrichment.js            # ⭐ Test with 5 facilities
│   │   ├── jci-scraper.js                # Scrape JCI directory
│   │   ├── enrich-facilities.js          # Google Places enrichment
│   │   ├── import-to-supabase.js         # Import to database
│   │   └── README.md                      # Script documentation
│   │
│   └── data/
│       ├── jci-facilities-test-sample.json      # 5 test facilities
│       ├── JCI-FACILITIES-MASTER-LIST.md        # 661 facility breakdown
│       ├── jci-facilities-raw.json              # (Generated by scraper)
│       └── jci-facilities-enriched.json         # (Generated by enricher)
│
├── 🎨 Source Code
│   ├── src/
│   │   ├── App.tsx                        # Main application
│   │   ├── index.tsx                      # Entry point
│   │   ├── index.css                      # Global styles
│   │   │
│   │   ├── components/
│   │   │   ├── Map/
│   │   │   │   └── GlobalFacilityMap.tsx # Mapbox map
│   │   │   ├── Cards/
│   │   │   │   └── FacilityCard.tsx      # Facility display
│   │   │   ├── Search/
│   │   │   │   └── ProcedureSearch.tsx   # Search bar
│   │   │   ├── Filters/
│   │   │   │   ├── CountryFilter.tsx     # Country filter
│   │   │   │   ├── SpecialtyFilter.tsx   # Specialty filter
│   │   │   │   └── ZanoFilter.tsx        # Zano payment filter
│   │   │   └── Outreach/
│   │   │       └── RequestZanoButton.tsx # Email facilities
│   │   │
│   │   └── lib/
│   │       └── supabase.ts               # Database client
│   │
│   └── public/                            # Static assets
│
├── ⚙️ Configuration
│   ├── .env.local                         # ⚠️ Environment variables (DO NOT COMMIT)
│   ├── .env.example                       # Example env file
│   ├── .gitignore                         # Git ignore rules
│   ├── package.json                       # Dependencies
│   ├── tsconfig.json                      # TypeScript config
│   ├── tailwind.config.js                 # Tailwind config
│   ├── postcss.config.js                  # PostCSS config
│   └── netlify.toml                       # Netlify deployment
│
└── 🗄️ Database
    └── database/
        ├── SETUP-DATABASE.sql             # Initial schema
        └── migrations/                    # Future migrations
```

---

## 🚀 Quick Navigation

### Just Getting Started?
1. **[QUICK-START-DATA-COLLECTION.md](QUICK-START-DATA-COLLECTION.md)** - Start here (15 min)
2. **[GOOGLE-PLACES-API-SETUP.md](GOOGLE-PLACES-API-SETUP.md)** - Get API key (10 min)
3. **Run test**: `GOOGLE_PLACES_API_KEY=your_key node scripts/test-enrichment.js`

### Need to Understand the Plan?
- **[DATA-COLLECTION-PLAN.md](DATA-COLLECTION-PLAN.md)** - Complete 4-week roadmap
- **[DATA-COLLECTION-STATUS.md](DATA-COLLECTION-STATUS.md)** - Current status
- **[data/JCI-FACILITIES-MASTER-LIST.md](data/JCI-FACILITIES-MASTER-LIST.md)** - 661 facility breakdown

### Working on Development?
- **[SKILLS.md](SKILLS.md)** - Best practices and troubleshooting
- **[scripts/README.md](scripts/README.md)** - Script documentation
- **[README.md](README.md)** - Full project documentation

### AI Assistant Working on This?
- **[../CLAUDE.md](../CLAUDE.md)** - Complete AI context (in parent directory)

---

## 📝 File Purposes

### Documentation Files

| File | Purpose | When to Use |
|------|---------|-------------|
| README.md | Project overview, setup instructions | First time setting up project |
| QUICK-START-DATA-COLLECTION.md | Fast track to 661 facilities | Ready to collect data NOW |
| GOOGLE-PLACES-API-SETUP.md | Google API key setup | Need API key |
| DATA-COLLECTION-PLAN.md | Detailed 4-week plan | Planning execution |
| DATA-COLLECTION-STATUS.md | Current progress report | Check what's done |
| SKILLS.md | Dev best practices | Development work |
| PROJECT-STRUCTURE.md | This file | Navigate project |

### Script Files

| File | Purpose | Command |
|------|---------|---------|
| test-enrichment.js | Test with 5 facilities | `GOOGLE_PLACES_API_KEY=key node scripts/test-enrichment.js` |
| jci-scraper.js | Scrape JCI directory | `node scripts/jci-scraper.js` |
| enrich-facilities.js | Google Places enrichment | `GOOGLE_PLACES_API_KEY=key node scripts/enrich-facilities.js` |
| import-to-supabase.js | Import to database | `node scripts/import-to-supabase.js` |

### Data Files

| File | Purpose | Size |
|------|---------|------|
| jci-facilities-test-sample.json | Test sample | 5 facilities |
| JCI-FACILITIES-MASTER-LIST.md | Complete breakdown | 661 facilities |
| jci-facilities-raw.json | Scraped data | Generated by scraper |
| jci-facilities-enriched.json | Enriched data | Generated by enricher |

### Source Files

| File | Purpose | Lines |
|------|---------|-------|
| App.tsx | Main React app | ~400 |
| lib/supabase.ts | Database client | ~200 |
| GlobalFacilityMap.tsx | Mapbox map | ~300 |
| FacilityCard.tsx | Facility display | ~150 |
| ProcedureSearch.tsx | Search bar | ~100 |

### Configuration Files

| File | Purpose | Critical? |
|------|---------|-----------|
| .env.local | API keys and secrets | ⚠️ YES - DO NOT COMMIT |
| package.json | Dependencies | ✓ |
| tsconfig.json | TypeScript config | ✓ |
| tailwind.config.js | Styling config | ✓ |
| netlify.toml | Deployment config | ✓ |

---

## 🎯 Workflows

### Data Collection Workflow
```
1. Get API Key
   └─→ GOOGLE-PLACES-API-SETUP.md

2. Test Pipeline
   └─→ scripts/test-enrichment.js
   └─→ Uses: data/jci-facilities-test-sample.json

3. Collect Data
   └─→ scripts/jci-scraper.js
   └─→ Outputs: data/jci-facilities-raw.json

4. Enrich Data
   └─→ scripts/enrich-facilities.js
   └─→ Outputs: data/jci-facilities-enriched.json

5. Import Data
   └─→ scripts/import-to-supabase.js
   └─→ Updates: Supabase database

6. Verify
   └─→ Open: http://localhost:3000
```

### Development Workflow
```
1. Setup Environment
   └─→ README.md (installation)
   └─→ .env.local (configuration)

2. Start Development
   └─→ npm start
   └─→ http://localhost:3000

3. Make Changes
   └─→ src/components/...
   └─→ SKILLS.md (best practices)

4. Test Changes
   └─→ Check browser
   └─→ Verify Supabase data

5. Deploy
   └─→ git push
   └─→ Netlify auto-deploys
```

---

## 🔐 Environment Variables (.env.local)

```bash
# Supabase
REACT_APP_SUPABASE_URL=https://whklrclzrtijneqdjmiy.supabase.co
REACT_APP_SUPABASE_ANON_KEY=eyJhbGci...

# Mapbox
REACT_APP_MAPBOX_TOKEN=pk.eyJ1Ijoi...

# EmailJS
REACT_APP_EMAILJS_SERVICE_ID=your_service_id
REACT_APP_EMAILJS_TEMPLATE_ID=your_template_id
REACT_APP_EMAILJS_PUBLIC_KEY=your_public_key

# Google Places (for data collection scripts)
GOOGLE_PLACES_API_KEY=AIzaSyA...
```

⚠️ **NEVER commit .env.local to Git!**

---

## 📊 Data Flow

```
JCI Directory (Web)
    ↓
[jci-scraper.js]
    ↓
jci-facilities-raw.json
    ↓
[enrich-facilities.js] ←─ Google Places API
    ↓
jci-facilities-enriched.json
    ↓
[import-to-supabase.js]
    ↓
Supabase Database
    ↓
[React App] ←─ Mapbox API
    ↓
User Browser
```

---

## 🎨 Component Hierarchy

```
App.tsx
├── GlobalFacilityMap.tsx
│   └── Mapbox markers
├── ProcedureSearch.tsx
├── Filters
│   ├── CountryFilter.tsx
│   ├── SpecialtyFilter.tsx
│   └── ZanoFilter.tsx
└── FacilityCard.tsx
    └── RequestZanoButton.tsx
```

---

## 💾 Database Schema

### facilities table
```sql
- id (uuid, primary key)
- name (text)
- country (text)
- city (text)
- lat (numeric)
- lng (numeric)
- jci_accredited (boolean)
- specialties (text[])
- popular_procedures (jsonb)
- languages (text[])
- google_rating (numeric)
- review_count (integer)
- accepts_zano (boolean)
- contact_email (text)
- website (text)
- phone (text)
- airport_distance (text)
- created_at (timestamp)
- updated_at (timestamp)
```

### zano_requests table
```sql
- id (uuid, primary key)
- facility_id (uuid, foreign key)
- status (text)
- requested_at (timestamp)
```

---

## 🚧 Common Tasks

### Add New Facility
```sql
INSERT INTO facilities (name, country, city, lat, lng, ...)
VALUES ('Hospital Name', 'Country', 'City', 0.0, 0.0, ...);
```

### Update Facility
```sql
UPDATE facilities
SET accepts_zano = true
WHERE id = 'uuid';
```

### Check Database
```sql
SELECT COUNT(*) FROM facilities;
SELECT country, COUNT(*) FROM facilities GROUP BY country;
```

### Test API Connection
```bash
curl "https://maps.googleapis.com/maps/api/place/textsearch/json?query=hospital&key=YOUR_KEY"
```

---

## 📈 Progress Tracking

### Current State
- ✅ 10 facilities live
- ✅ Infrastructure complete
- ⏳ API key needed
- ⏳ 651 facilities pending

### Milestones
- **Week 1**: 140 facilities (Tier 1)
- **Week 2**: 260 facilities (Tier 2)
- **Week 3**: 340 facilities (Tier 3)
- **Week 4**: 661 facilities (Complete)

---

## 🆘 Need Help?

1. **Getting started**: [QUICK-START-DATA-COLLECTION.md](QUICK-START-DATA-COLLECTION.md)
2. **Development issues**: [SKILLS.md](SKILLS.md)
3. **Script problems**: [scripts/README.md](scripts/README.md)
4. **Planning questions**: [DATA-COLLECTION-PLAN.md](DATA-COLLECTION-PLAN.md)

---

## 🎯 Next Action

```bash
# If you have Google Places API key:
GOOGLE_PLACES_API_KEY=your_key node scripts/test-enrichment.js

# If you need API key:
# See: GOOGLE-PLACES-API-SETUP.md (10 minutes)
```

**Once test passes, you're ready to scale to 661 facilities!** 🚀

---

**Updated**: 2025-10-29
**Status**: Infrastructure Complete ✅
